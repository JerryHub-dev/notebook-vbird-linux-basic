# 10.6 管道命令 pipe

管道命令【|】仅能处理前一个命令传来的正确信息（stdout），不能处理错误信息（stderr）。<br />管道后面接的第一个数据必定是【命令】，而这个命令必须要能够接受标准输入（stdin）的数据才行，如：

- less、more、head、tail 等都是管道命令
- ls、cp、mv 等不是

## 10.6.1 选取命令：cut、grep

选取信息通常是针对“一行一行”来分析的，并不是整片信息

### cut

将一段信息的某一段“切”出来。<br />主要的用途在于将同一行里的数据进行分解，最常使用在分析一些数据或文字数据的时候。

```bash
# 用于有特定分隔符
$ cut -d '分隔符' -f fields

# 用于排列整齐的信息
$ cut -c 字符区间

# 选项与参数
# -d：后接分隔符，与 -f 一起使用
# -f：根据 -d 的分隔符将一段信息划分为数段，用 -f 取出第几段
# -c：以字符的单位取出固定字符区间

# 示例

# 1. 将 PATH 变量取出，找出第 5 个路径
$ echo ${PATH} | cut -d ':' -f 5

# 2. 将 PATH 变量取出，找出第 3 和 第 5 个路径
$ echo ${PATH} | cut -d ':' -f 3,5

# 3. 将 export 输出的信息，取出第 12 个字符后的所有字符
$ export | cut -c 12-
# 输出的结果每一行都会删除前 12 个字符
# 还可以指定某个范围的值，如 cut -c 12-20
```

### grep

分析一行信息，若当中有需要的信息，就将该行拿出来。相当于根据查找字符过滤行。

```bash
$ grep [-acinv] [--color=auto] '查找字符' [filename]

# 选项与参数
# -a：将二进制文件以文本文件的方式查找数据
# -c：计算找到 '查找字符' 的次数
# -i：忽略大小写
# -n：输出行号
# -v：反向选择
# --color=auto：将找到的关键字部分加上颜色显示（CentOS 7.x 中已使用别名默认添加）

# 示例

# 1. 将 last 中有出现 root 的行显示出来
$ last | grep 'root'

# 2. 与 1. 相反，显示没有 root 的行
$ last | grep -v 'root'

# 3. 取出 /etc/man_db.conf 中含 MANPATH 的行
$ grep 'MANPATH' /etc/man_db.conf
```

## 10.6.2 排序命令：sort、uniq、wc

### sort：排序

```bash
$ sort [-fbMnrtuk] [filename or stdin]

# 选项与参数
# -f：忽略大小写
# -b：忽略最前面的空格
# -M：以月份名称来排序，如 JAN、DEC 等
# -n：使用纯数字排序，默认是以文字形式
# -r：反向排序
# -u：uniq，相同的数据，仅出现一行
# -t：分隔符号，默认以 [Tab] 键来分隔
# -k：以分隔后的哪一栏来排序

# 示例

# 1. 将 /etc/passwd 按照个人账号排序
$ cat /etc/passwd | sort
# sort 默认会以第一栏来排序，个人账号刚好是第一栏

# 2. 将 /etc/passwd 按照第三栏排序
$ cat /etc/passwd | sort -t ':' -k 3
```

### uniq：将排序后的重复数据仅列出一个来显示

```bash
$ uniq [-ic]

# 选项与参数
# -i：忽略大小写
# -c：计数

# 示例

# 1. 将 last 列出的账号仅取出账号栏，进行排序后仅取出一位
$ last | cut -d ' ' -f1 | sort | uniq

# 2. 在 1. 的基础上显示次数
$ last | cut -d ' ' -f1 | sort | uniq -c
```

### wc：计数

```bash
$ wc [-lwm]

# 选项与参数
# -l：仅列出行
# -w：仅列出多少字（英文字母）
# -m：多少字符

# 示例

# 显示 /etc/man_db.conf 中的行数、字数、字符数
$ cat /etc/man_db.conf | wc
```
