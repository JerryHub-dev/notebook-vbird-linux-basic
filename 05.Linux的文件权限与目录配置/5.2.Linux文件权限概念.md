# 5.2 Linux 文件权限概念

## 5.2.1 Linux 文件属性

【ls -l 】默认显示的文件属性中，共有七个字段：

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12735713/1664070167743-6635736f-1544-4b06-8b11-4bc256d299c8.png#clientId=u87181d60-e398-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=204&id=u955a6066&margin=%5Bobject%20Object%5D&name=image.png&originHeight=183&originWidth=588&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20366&status=done&style=shadow&taskId=ub188875e-0c77-496a-adc0-68fd34f5fe3&title=&width=654)

- 一：文件的权限，共十个字符
  - 第一个字符：文件类型
  - 其它九个字符三个为一组，且均为【rwx】的固定顺序组合，没有权限时为【-】
    - 第一组：文件拥有者的权限
    - 第二组：加入此用户组的账号权限
    - 第三组：其他账号的权限
- 二：链接数，表示有多少文件名链接到此节点（inode）
- 三：文件（或目录）的拥有者账号
- 四：文件的所属用户组
- 五：文件的容量大小，默认单位为 Bytes
- 六：文件的创建日期或最近修改日期
- 七：文件名
  - 【.】开头的文件为隐藏文件

## 5.2.2 如何修改文件属性与权限

### 修改所属用户组：chgrp（change group）

```bash
$ chgrp [-R] groupname dirname/filename ...

# 选项与参数
# -R：进行递归（recursive）修改

# 示例
$ chgrp users initial-setup-ks.cfg

# 注意：要被修改的组名必须要在 /etc/group 文件中存在，否则会报错，如：
$ chgrp test initial-setup-ks.cfg
```

### 修改文件拥有者：chown（change owner）

```bash
$ chown [-R] accountname dirname/filename

# 同时修改用户组名称
$ chown [-R] accountname:groupname dirname/filename

# 选项与参数
# -R：进行递归（recursive）修改

# 示例
$ chown bin initial-setup-ks.cfg

$ chown root:root initial-setup-ks.cfg
```

### 修改权限：chmod（change mode）

两种修改方法：

- 数字法
- 符号法

#### 数字法

权限数字：

- r：4
- w：2
- x：1

三个权限数字累加，如：

```bash
rwx = 4+2+1 = 7
rw- = 4+2+0 = 6
--- = 0+0+0 = 0
```

chmod 命令格式：

```bash
$ chmod [-R] xyz dirname/filename

# 选项与参数
# -R：进行递归（recursive）修改
# xyz：权限数字累加值

# 示例

# 权限 -rwxrwxrwx
$ chmod 777 .bashrc

# 权限 -rw-r--r--
$ chmod 644 .bashrc
```

#### 符号法

| 命令  | 身份                                                    | 运算                                    | 权限              | 对象       |
| ----- | ------------------------------------------------------- | --------------------------------------- | ----------------- | ---------- |
| chmod | u（user）<br/> g（group）<br/> o（other）<br/> a（all） | +（加入）<br/> -（移除）<br/> =（设置） | r <br/> w <br/> x | 文件或目录 |

```bash
# 示例

# 权限 -rwxr-xr-x
$ chmod u=rwx,g=rx,o=rx .bashrc

# 权限 -rwxr-xr--
$ chmod u=rwx,g=rx,o=r .bashrc

# 如果不知道原来权限，只想给所有账号追加 w
$ chmod a+w .bashrc
# -rwxrwxrwx

# 将所有账号可执行权限移除
$ chmod a-x .bashrc
# -rw-rw-rw-
```

## 5.2.3 目录与文件的权限意义

### 权限对文件的重要性

文件是实际含有数据的地方，包括一般文本文件、数据库文件、二进制可执行文件等。

权限对于文件的意义：

| 权限 | 含义    | 说明                                                    | 备注                                                                                                  |
| ---- | ------- | ------------------------------------------------------- | ----------------------------------------------------------------------------------------------------- |
| r    | read    | 可读取此文件的实际内容                                  |                                                                                                       |
| w    | write   | 可以编辑、新增或是修改文件的内容 （但不含删除该文件！） | 都是针对文件的内容而言                                                                                |
| x    | execute | 该文件具有可以被系统执行的权限                          | Linux 中的文件能否被执行，是根据【x】这个权限来决定，跟文件名（如 .exe、.bat、.com 等）没有绝对的关系 |

### 权限对目录的重要性

目录主要的内容在记录文件名列表，文件名与目录有强烈的关联。

权限对于目录的意义：

| 权限 | 含义                         | 说明                                       | 备注                                                                                                                                                |
| ---- | ---------------------------- | ------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------- |
| r    | read contents in directory   | 读取目录结构列表，查询该目录下的文件名数据 | 可以用【ls 】来显示内容列表                                                                                                                         |
| w    | modify contents of directory | 改动该目录结构列表！                       | - 建立新的文件与目录<br/>- 删除已存在的文件与目录（不论对该文件的权限是什么！）<br/>- 修改已存在的文件后目录名称<br/>- 移动该目录内的文件、目录位置 |
| x    | access directory             | 能否进入该目录成为工作目录！               | 能否进入某一个目录，只与该目录的 [x] 权限有关！                                                                                                     |

## 5.2.4 Linux 文件种类与扩展名

> 任何设备在 Linux 中都是文件

### 文件种类

| 种类名称       | 英文         | 分类                                         | 标识符 | 举例       |
| -------------- | ------------ | -------------------------------------------- | ------ | ---------- |
| 常规文件       | regular file | - 纯文本文件<br/>- 二进制文件<br/>- 数据文件 | [-]    |            |
| 目录           | directory    |                                              | [d]    |            |
| 链接文件       | link         |                                              | [l]    |            |
| 设备与设备文件 | divice       | 区块设备文件（block）                        | [b]    | 硬盘、软盘 |
|                |              | 字符设备文件（character）                    | [c]    | 键盘、鼠标 |
| 数据接口文件   | sockets      |                                              | [s]    |            |
| 数据输送文件   | FIFO，pipe   |                                              | [p]    |            |

### 文件扩展名

- Linux 中没有所谓的扩展名
- 一个 Linux 文件能否被执行，与它的文件属性及权限属性有关，与文件名没有任何关系
- 只要权限中具有 [x]，即代表这个文件具有可以被执行的能力，但文件能否执行成功，则得看文件的内容

### 文件名长度限制

单一文件或目录最大 255 字节

### 文件名限制

需要避免的特殊字符：

```bash
* ? > < ; & ! [ ] | \ ' " ` ( ) { }
```

文件名称开头需要避免：

```bash
- +
```

【.】开头代表隐藏文件
