# 7.2 文件系统的简单操作

## 7.2.1 磁盘与目录的容量

### df（列出文件系统的整体磁盘使用量）

```bash
# df [-ahikHTm] [目录或文件名]

# 主要选项与参数
# -a：显示所有文件系统
# -k：以 KBytes 容量显示
# -m：以 MBytes 容量显示
# -h：以易读的方式显示
# -i：不用磁盘容量，而以 inode 的数量来显示


# 示例

# 将系统内所有的文件系统全部列出来
# df

# 将容量结果以易读的格式显示出来
# df -h

# 显示 /etc 目录下的磁盘容量
# df -h /etc

# 将目前各个硬盘分区可用的 inode 数量列出
# df -ih
```

【df】主要读取的数据几乎都是针对整个文件系统，因此读取的范围主要是在超级区块内的信息，显示结果速度非常快。

### du（查看文件系统的磁盘使用量，常用在查看目录所占磁盘空间）

```bash
# du [-ahskm] 目录或文件名

# 主要选项与参数
# -a：显示所有文件与目录容量
# -h：以易读的方式显示
# -s：仅列出总量，而不列出每个各别的目录占用情况
# -k：以 KBytes 容量显示
# -m：以 MBytes 容量显示

# 示例

# 列出目前目录下的所有文件容量（仅会显示目录容量，不含文件）
# du

# 列出目前目录下的所有文件容量，同时列出文件容量
# du -a

# 查看根目录下每个目录所占用的容量
# du -sm /*
```

与【df】不同，【du】会直接到文件系统内查找所有的文件数据，所以执行时间相对会长一些。

## 7.2.2 硬链接与符号链接：ln

在 Linux 下的链接文件有两种：

- 硬链接
- 符号链接

### 硬链接（Hard Link，硬式链接或实际链接）

硬链接：通过文件系统的 inode 链接来产生新文件名，而不是产生新文件。只是在某个目录下新增一个文件名链接到某 inode 号码的关联记录。

```bash
# 建立硬链接
# ln /etc/crontab .
```

好处：

- 安全（如果将任何一个文件名删除，inode 与区块都还是存在）

限制：

- 不能跨文件系统
- 不能链接目录

### 符号链接（Symbolic Link，快捷方式）

符号链接：建立一个独立的文件，这个文件会让数据的读取指向它链接的那个文件的文件名。类似于 windows 的快捷方式。<br />由符号链接所建立的文件为一个独立的新文件，会占用 inode 与区块。<br />当源文件被删除之后，符号链接的文件会打不开。

```bash
# 建立符号链接
# ln -s /etc/crontab crontab2
```

链接文件的重要内容就是它会写上目标文件的文件名，因此链接文件的大小基本上就是文件名的字符大小。

### ln 命令

```bash
# ln [-sf] 源文件 目标文件

# 选项与参数
# -s：如果不加任何参数，为硬链接，-s 表示符号链接
# -f：如果目标文件存在时，就将目标文件删除后再建立
```

### 关于目录的链接数量

一个空目录至少会存在两个目录：

- .
- ..

当建立一个新目录 /tmp/test 时，会有三个东西：

- /tmp/test
- /tmp/test/.
- /tmp/test/..

/tmp/test 与 /tmp/test/. 相同，都代表该目录；而 /tmp/test/.. 则代表 /tmp<br />因此，当建立一个新的目录时，新的目录链接数为 2，上层目录的链接数会增加 1
