# 6.4 文件与目录的默认权限与隐藏权限

## 6.4.1 文件默认权限：umask

【umask】指定目前用户在建立文件或目录时的权限默认值。

文件与目录的默认权限：

- 若为文件，默认权限为【-rw-rw-rw-】（666）
- 若为目录，默认权限为【drwxrwxrwx】（777）
  > umask 的数字指的是该默认值需要减掉的权限

查看当前的 umask 值：

```bash
$ umask
# 0022，与一般权限有关的是后面三个数字

# 或
$ umask -S
# u=rwx,g=rx,o=rx
```

修改 umask 值：

```bash
# 示例
$ umask 002
```

## 6.4.2 文件隐藏属性

### 6.4.2.1 chattr（配置文件隐藏属性）

```bash
$ chattr [+-=] [ASacdistu] 文件或目录

# 重要参数
# a：文件只能增加数据，而不能修改数据，只有 root 才能设置该属性
# i：可以让一个文件不能被删除、改名、设置链接也无法写入或新增数据，只有 root 才能设置该属性

# 注意 + - ，可以增加/删除属性
```

### 6.4.2.2 lsattr（显示文件隐藏属性）

```bash
$ lsattr [-adR] 文件或目录
```

:::warning
注意：chattr 与 lsattr 在使用时必须特别小心！
:::

## 6.4.3 文件特殊权限：SUID、SGID、SBIT

### 6.4.3.1 Set UID

当【s】标志出现在【文件拥有者】的【x】权限上时（如【-rwsr-xr-x】），被称为 Set UID，简称为 SUID 特殊权限。

#### SUID 的限制与功能

- 仅对二进制程序有效
- 执行者对于该程序需要具有【x】的可执行权限
- 本权限仅在执行该程序的过程中有效
- 执行者将具有该程序【拥有者】的权限
- 对目录无效

### 6.4.3.2 Set GID

当【s】标志出现在【用户组】的【x】权限上时（如【-rwxr-sr-x】），被称为 Set GID，简称为 SGID 特殊权限。

#### SGID 的限制与功能

- 如果是文件：
  - 对二进制程序有用
  - 程序执行者对于该程序来说，需具备【x】的权限
  - 执行者在执行过程中将获得该程序【用户组】的支持
- 如果是目录：
  - 用户若对于此目录具有【r】与【x】权限时，该用户能够进入此目录
  - 用户在此目录下的【有效用户组】将变成该目录的用户组
  - 用途：若用户在此目录下具有【w】权限，则用户所建立的新文件，该新文件的用户组与此目录的用户组相同

### 6.4.3.3 Sticky Bit

如【-rwxr-xr-t】<br />SBIT 的限制与功能：

- 只对目录有效
- 当用户对于此目录具有【w】【x】权限，即具有写入的权限
- 当用户在该目录下建立文件或目录时，仅有自己与 root 才有权利删除该文件

### 6.4.3.4 SUID/SGID/SBIT 权限设置

#### 数字法

在原来权限的三个数字之前再加一位数字：

- SUID：4
- SGID：2
- SBIT：1
  > 如【-rwsr-xr-x】对应 4755

#### 符号法

- SUID：u+s
- SGID：g+s
- SBIT：o+t
  :::warning
  注意：S、T 代表权限为空
  :::

## 6.4.4 观察文件类型：file

```bash
# 示例
$ file ~/.bashrc
```
